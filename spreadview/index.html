<!DOCTYPE html>
<head>
    <title>Spreadview Demo</title>
</head>
<body>
    <noscript>This site requires JavaScript</noscript>
    <h1>Spreadview</h1>
    <script src="js/papaparse.min.js"></script>
    <script>
        var opts = {
            doc_csv: 'https://docs.google.com/spreadsheets/d/1joWXuUGEVKkSKffhg1Ea20lrZoEEk-ORRmrwZ9L17hM/pub?output=csv',
            skip_lines: 1
        };

        Papa.parse(opts.doc_csv, {
            download: true,
            complete: function(results) {
                var snipped = results.data.slice(opts.skip_lines || 0);

                //xform lines to array of objects indexed by header
                var headers = snipped[0];
                var indexed = snipped.slice(1).map(function(line) {
                    var o = {};
                    for(var i = 0; i < line.length; i++) {
                        o[headers[i]] = line[i];
                    }
                    return o;
                });
                console.log(out);
            }
        });
    </script>
</body>
